\documentclass[10pt,a4j,twocolumn]{jsarticle}

\usepackage[dvipdfmx]{graphicx}
\usepackage{url}
\setlength{\textheight}{275mm}
\headheight 5mm
\topmargin -30mm
\textwidth 185mm
\oddsidemargin -15mm
\evensidemargin -15mm
\pagestyle{empty}
\begin{document}
\title{RubyからMapleを呼び出すインターフェースライブラリの開発}
\author{情報科学科 西谷研究室 3528 村瀬愛理}
\date{}
\maketitle
\section{開発の背景}
Rubyは数値計算関連の環境整備が遅れており，Ruby上で高等な関数，
例えば，大きな素数を求めたり，最小公倍数を求めるなど
の処理を行うのが難しい．
一方で，Ruby以外の数式処理ソフトウェアなどを立ち上げて，
別々に作業するよりもRubyのみでプログラミングする方が，開発速度の格段の向上が期待できる．
そこで本研究では，数式処理ソフトウェアの１つであるMapleをRuby上で呼び出し，
Mapleに計算をさせて，その結果をRubyが取得するインターフェースライブラリの開発を目的とする．

\section{手法}
\subsection{Mapleとは}
Mapleは，1980年にカナダ・ウォータールー大学で生まれた数式処理技術をコアテクノロジーとして持つ
科学・技術・工学・数学（STEM : Science, Technology, Engineering and Mathematics）に関する統合的計算環境である\cite{Maple}.
特徴として，たくさんの数学関数が用意されていること，大きな桁数の計算が可能であること，グラフの描画が簡単であることなどが挙げられる．

\subsection{Mapleとの通信手法}
Mapleは一般的には，上述のとおり，
グラフや数式の綺麗な出力や，数式の入力を初心者が直感的におこなえるように
Javaで作られたGUIを使って実行する．
それとは別にcommand lineで実行される計算エンジン部が用意されている．
そこで，開発するRubyライブラリでは，このエンジンに直接働きかけて操作する．

Rubyで外部コマンドを実行するgem libraryのsystemuを使って，出力を得るようにしている．
Ruby codeで要求コードを受け取った場合，そのコードをtmp.mwに書き込む．
それをMapleで実行し，結果をテキストファイルで受けとることで出力を得る．

\section{進捗状況}
\subsection{Maple関数の類型化}
手始めに，関数として表1に記したものを準備した．
これらはRSA暗号化を実行するRubyプログラムの作成を意図している．
それぞれ，関数の振る舞いと入出力の型を分類している．
\begin{table}[htbp]\begin{center}
\caption{このインターフェースライブラリで想定している関数の役割と入出力型．}
\begin{tabular}{lllll}
\hline
関数名  &振る舞い  &入力型  &出力型  \\ \hline
nextprime  &次の素数を求める  &int  &int  \\
lcm  &最小公倍数  &int,int  &int  \\
gcd  &最大公約数  &int,int  &int  \\
rand  &乱数生成  &int  &int  \\
isprime  &素数判定  &int  &boolean  \\
ifactor  &素因数分解  &int  &string{\footnotesize (注1)}  \\
mod  &剰余  &int,int  &int  \\
\hline
\end{tabular}
\end{center}
{\footnotesize 注1:()に数値が囲われた状態で出力される．}
\label{default}
\end{table}
%for inserting separate lines, use \hline, \cline{2-3} etc.

\subsection{出力の切り替え}
Mapleから受け取ったままの出力は，値の前にスペースがたくさん入っていることや，
出力がString型であることから，その数値を使って計算をするようにプログラミングしていた場合に
支障をきたす．このため，関数ごとに正しい型で出力できるようにwrapperを作る．
例えば，int型で出力が欲しいものはexecを\verb|exec_i|から呼び出すことで対応する．
このようにbooleanやfloatといった出力型に応じて，\verb|exec_b,exec_f|のように関数を増やしていく．また，入力に応じても同様の対応を考えている．

\section{今後の課題}
上述のようにMapleで用意されている関数を類型化して，対応するメソッドを作成していく．
現時点での課題は次のとおりである．
\begin{itemize}
\item テキストファイルで受け取る際に，プログラムに出力したい結果が複数個あると一番最後に実行されたものしか出力されない．複数個の結果の出力に対応させる．
\item 行列データの読み込みと書き出しに対応させる．
\end{itemize}

\begin{flushleft}
\begin{thebibliography}{9}
\bibitem{Maple}「Maple(メイプル)とは」, サイバネット, \url{http://www.cybernet.co.jp/maple/product/maple/about.html}, 2016/09/02 アクセス．
\end{thebibliography}
\end{flushleft}
\end{document}
